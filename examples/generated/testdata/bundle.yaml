# Generated by openapi-operator-gen v0.0.10-7-g3ef1d52-dirty
# Example PetstoreBundle CR without status (spec only)
# This demonstrates creating a bundle CR for testing
#
# Usage with cel-test:
#   cel-test expressions --cr testdata/bundle.yaml
#   cel-test expressions --cr testdata/bundle.yaml --resources testdata/resources.yaml
apiVersion: petstore.example.com/v1alpha1
kind: PetstoreBundle
metadata:
  name: petstore-bundle
  namespace: default
spec:
  # Resources to include in the bundle
  resources:
    - kind: Order
      name: my-order
    - kind: Pet
      name: my-pet
    - kind: User
      name: my-user
  # Derived values using CEL expressions
  derivedValues:
    - name: syncPercentage
      expression: "summary.total > 0 ? (summary.synced * 100) / summary.total : 0"
    - name: allSynced
      expression: "summary.total > 0 && summary.synced == summary.total"
    - name: failedResources
      expression: "resources.filter(r, r.status.state == 'Failed').size()"
    - name: orderCount
      expression: "resources.filter(r, r.kind == 'Order').size()"
    - name: petCount
      expression: "resources.filter(r, r.kind == 'Pet').size()"
    - name: userCount
      expression: "resources.filter(r, r.kind == 'User').size()"
