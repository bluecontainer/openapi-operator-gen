# Generated by openapi-operator-gen v0.0.10-20-ge0145f7-dirty
# Example PetstoreBundle CR with populated status
# This demonstrates using cel-test with status data from a CR
#
# Usage with cel-test:
#   cel-test expressions --cr testdata/bundle-with-status.yaml
#   cel-test expressions --cr testdata/bundle-with-status.yaml --resources testdata/resources.yaml
apiVersion: petstore.example.com/v1alpha1
kind: PetstoreBundle
metadata:
  name: petstore-bundle-with-status
  namespace: default
spec:
  # Resources to include in the bundle
  resources:
    - kind: Order
      name: my-order
    - kind: Pet
      name: my-pet
    - kind: User
      name: my-user
  # Derived values using CEL expressions
  derivedValues:
    - name: syncPercentage
      expression: "summary.total > 0 ? (summary.synced * 100) / summary.total : 0"
    - name: allSynced
      expression: "summary.total > 0 && summary.synced == summary.total"
    - name: failedResources
      expression: "resources.filter(r, r.status.state == 'Failed').size()"
    - name: orderCount
      expression: "resources.filter(r, r.kind == 'Order').size()"
    - name: petCount
      expression: "resources.filter(r, r.kind == 'Pet').size()"
    - name: userCount
      expression: "resources.filter(r, r.kind == 'User').size()"
status:
  state: Synced
  message: "All resources synced successfully"
  summary:
    total: 3
    synced: 3
    failed: 0
    pending: 0
  resources:
    - kind: Order
      name: my-order
      namespace: default
      state: Synced
      externalID: "ext-my-order"
      message: "Successfully synced"
    - kind: Pet
      name: my-pet
      namespace: default
      state: Synced
      externalID: "ext-my-pet"
      message: "Successfully synced"
    - kind: User
      name: my-user
      namespace: default
      state: Synced
      externalID: "ext-my-user"
      message: "Successfully synced"
  derivedValues:
    syncPercentage: 100
    allSynced: true
    failedResources: 0
    orderCount: 1
    petCount: 1
    userCount: 1
  lastReconcileTime: "2026-02-11T23:06:49Z"
